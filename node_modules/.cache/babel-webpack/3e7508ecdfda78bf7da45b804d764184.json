{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore, AngularFirestoreCollection } from '@angular/fire/firestore';\nimport firebase from 'firebase/app';\nimport * as moment from 'moment';\nimport { AlertController } from '@ionic/angular';\nimport { InAppBrowser } from '@ionic-native/in-app-browser/ngx';\nimport 'firebase/firestore';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/fire/firestore\";\nimport * as i4 from \"@angular/fire/database\";\nimport * as i5 from \"@angular/fire/auth\";\nimport * as i6 from \"@ionic-native/in-app-browser/ngx\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/forms\";\n\nfunction EventoPesquisaPage_ion_title_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-title\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.eventodb.nome);\n  }\n}\n\nfunction EventoPesquisaPage_ion_content_5_ion_item_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-item\", 12);\n    i0.ɵɵlistener(\"click\", function EventoPesquisaPage_ion_content_5_ion_item_20_Template_ion_item_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return ctx_r4.redirectmap();\n    });\n    i0.ɵɵelement(1, \"ion-icon\", 20);\n    i0.ɵɵelementStart(2, \"h2\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r2.eventodb.local.description);\n  }\n}\n\nfunction EventoPesquisaPage_ion_content_5_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"ion-item\", 21);\n    i0.ɵɵelementStart(2, \"ion-avatar\", 22);\n    i0.ɵɵelement(3, \"img\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"h2\", 11);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const kdcoment_r6 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", kdcoment_r6.img, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", kdcoment_r6.username, \" : \", kdcoment_r6.comentarioU, \" \");\n  }\n}\n\nfunction EventoPesquisaPage_ion_content_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-content\");\n    i0.ɵɵelementStart(1, \"div\");\n    i0.ɵɵelementStart(2, \"ion-card\", 5);\n    i0.ɵɵelement(3, \"img\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-list\", 7);\n    i0.ɵɵelementStart(5, \"ion-item\");\n    i0.ɵɵelementStart(6, \"ion-button\", 8);\n    i0.ɵɵlistener(\"click\", function EventoPesquisaPage_ion_content_5_Template_ion_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.UP();\n    });\n    i0.ɵɵtext(7, \"UP\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"ion-item\");\n    i0.ɵɵelement(10, \"ion-icon\", 9);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ion-item\");\n    i0.ɵɵelement(13, \"ion-icon\", 10);\n    i0.ɵɵelementStart(14, \"h2\", 11);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"ion-item\", 12);\n    i0.ɵɵlistener(\"click\", function EventoPesquisaPage_ion_content_5_Template_ion_item_click_16_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.redirectlink();\n    });\n    i0.ɵɵelement(17, \"ion-icon\", 13);\n    i0.ɵɵelementStart(18, \"h2\", 11);\n    i0.ɵɵtext(19, \"Link\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(20, EventoPesquisaPage_ion_content_5_ion_item_20_Template, 4, 1, \"ion-item\", 14);\n    i0.ɵɵelementStart(21, \"ion-item\", 12);\n    i0.ɵɵlistener(\"click\", function EventoPesquisaPage_ion_content_5_Template_ion_item_click_21_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.redirectUser();\n    });\n    i0.ɵɵelement(22, \"ion-icon\", 15);\n    i0.ɵɵelementStart(23, \"h2\", 11);\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"ion-list\", 7);\n    i0.ɵɵelementStart(26, \"ion-item\", 16);\n    i0.ɵɵelementStart(27, \"ion-input\", 17);\n    i0.ɵɵlistener(\"ngModelChange\", function EventoPesquisaPage_ion_content_5_Template_ion_input_ngModelChange_27_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.comentario = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"ion-button\", 18);\n    i0.ɵɵlistener(\"click\", function EventoPesquisaPage_ion_content_5_Template_ion_button_click_28_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.setcoment();\n    });\n    i0.ɵɵtext(29, \" Enviar \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"ion-list\", 7);\n    i0.ɵɵtemplate(31, EventoPesquisaPage_ion_content_5_div_31_Template, 6, 3, \"div\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r1.eventodb.url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.jadeuUP);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.eventodb.UPnum, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.numcoments, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.eventodb.dia, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.eventodb.local);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.eventodb.userID[1]);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.comentario);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.noAuth);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.coments);\n  }\n}\n\nexport let EventoPesquisaPage = /*#__PURE__*/(() => {\n  class EventoPesquisaPage {\n    constructor(alert, route, firestore, Firebase, auth, router, iab) {\n      this.alert = alert;\n      this.route = route;\n      this.firestore = firestore;\n      this.Firebase = Firebase;\n      this.auth = auth;\n      this.router = router;\n      this.iab = iab;\n      this.noAuth = true;\n      this.pode = false;\n      this.numcoments = 0;\n      this.jadeuUP = false;\n      this.comentario = \"\";\n      this.ComentSet = {\n        img: '',\n        username: '',\n        comentarioU: '',\n        UID: ''\n      };\n      this.eventoID = this.route.snapshot.paramMap.get('chave');\n      this.getevento(this.eventoID);\n    }\n\n    ngOnInit() {\n      this.auth.onAuthStateChanged(user => {\n        if (user) {\n          // User is signed in, see docs for a list of available properties\n          // https://firebase.google.com/docs/reference/js/firebase.User\n          var uid = user.uid;\n          console.log(\"logado por aqui\");\n          this.iduser = uid; // ...\n        } else {\n          this.iduser == null;\n          console.log(\"Deslogado\"); // User is signed out\n          // ...\n        }\n      });\n    }\n\n    user() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const res = yield this.auth.currentUser;\n\n        if (res != null) {\n          this.imgus = res.photoURL;\n          this.iduser = res.uid;\n          this.nome = res.displayName;\n        }\n      });\n    }\n\n    jaUpou() {\n      if (this.iduser == null) {\n        this.showAlertLogin();\n      }\n\n      if (this.eventodb.up.includes(this.iduser)) {\n        this.jadeuUP = true;\n      }\n    }\n\n    redirectUser() {\n      this.router.navigate(['/usuario-pesquisa/' + this.eventodb.userID[0]]);\n    }\n\n    getevento(tt) {\n      //refazer\n      this.evento = this.firestore.collection('eventos', ref => ref.where('chave2', '==', `${tt}`)); // Firestore evento\n\n      return this.evento.get().subscribe(coisas => {\n        coisas.forEach(b => {\n          const data = b.data();\n          const id = b.id;\n          moment.locale('pt-BR');\n          this.m = moment(data.dia).format('ddd DD MMM - HH:mm');\n          data.dia = this.m;\n          this.eventodb = Object.assign({\n            id\n          }, data);\n          this.getComent(this.eventodb.id);\n          this.lugardocomentario = this.Firebase.list(`coments/${this.eventodb.id}`, ref => ref.limitToLast(75));\n          console.log(this.eventodb);\n          this.pode = true;\n        });\n      });\n    }\n\n    redirectlink() {\n      const browser = this.iab.create(`${this.eventodb.ingresso}`, '_system', {\n        location: 'no'\n      });\n      browser.on('loadstop').subscribe(event => {\n        browser.insertCSS({\n          code: \"body{color: red;\"\n        });\n      });\n      browser.close();\n    }\n\n    redirectmap() {\n      const map = this.iab.create(`https://www.google.com/maps/search/?api=1&query=${this.eventodb.local.description}`, '_system');\n      map.on('loadstop').subscribe(event => {\n        map.insertCSS({\n          code: \"body{color: red;\"\n        });\n      });\n      map.close();\n    }\n\n    setcoment() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.user();\n        const res = yield this.auth.currentUser;\n        this.ComentSet = {\n          img: this.imgus,\n          username: this.nome,\n          comentarioU: this.comentario,\n          UID: this.iduser\n        };\n        this.lugardocomentario.push(this.ComentSet);\n        this.comentario = \"\";\n      });\n    }\n\n    getComent(x) {\n      this.lugaresdocomentario = this.Firebase.list(`coments/${x}`, ref => ref.limitToLast(75));\n      console.log(x);\n      this.lugaresdocomentario.valueChanges().subscribe(data => {\n        this.trataDados(data);\n      });\n    }\n\n    trataDados(dados) {\n      this.coments = Object.keys(dados).map(i => dados[i]);\n      this.numcoments = this.coments.length;\n      this.todoscoments = this.coments;\n    }\n\n    page(kdcoment) {\n      this.router.navigate(['/usuario-pesquisa/' + kdcoment.UID]);\n    }\n\n    showAlertLogin() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alert.create({\n          header: 'Ops!',\n          message: 'Crie ou entre em uma conta para usar ups e comentários.',\n          buttons: [{\n            text: 'Criar / Entrar',\n            handler: () => {\n              this.router.navigate(['/criar-user']);\n            }\n          }, {\n            text: 'Ok',\n            handler: () => {\n              console.log('Confirm Okay');\n            }\n          }]\n        });\n        yield alert.present();\n      });\n    }\n\n    UP() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.jadeuUP = true;\n        const res = yield this.auth.currentUser;\n\n        if (this.eventodb.up.includes(this.iduser)) {\n          return this.showalert(\"Ops!\", \"Você ja deu UP nesse evento\");\n        } else {\n          this.upReference = this.firestore.doc(`eventos/${this.eventodb.id}`);\n          this.upReference.update({\n            up: firebase.firestore.FieldValue.arrayUnion(res.uid),\n            UPnum: firebase.firestore.FieldValue.increment(1)\n          });\n          this.eventodb.UPnum += 1;\n        }\n      });\n    }\n\n    showalert(header, message) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alert.create({\n          header,\n          message,\n          buttons: [\"Ok\"]\n        });\n        yield alert.present();\n      });\n    }\n\n    Compartilhar() {\n      this.router.navigate(['/share/' + this.eventodb.chave2]);\n    }\n\n  }\n\n  EventoPesquisaPage.ɵfac = function EventoPesquisaPage_Factory(t) {\n    return new (t || EventoPesquisaPage)(i0.ɵɵdirectiveInject(i1.AlertController), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.AngularFirestore), i0.ɵɵdirectiveInject(i4.AngularFireDatabase), i0.ɵɵdirectiveInject(i5.AngularFireAuth), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i6.InAppBrowser));\n  };\n\n  EventoPesquisaPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EventoPesquisaPage,\n    selectors: [[\"app-evento-pesquisa\"]],\n    decls: 6,\n    vars: 2,\n    consts: [[\"size\", \"large\", \"class\", \"centertt\", 4, \"ngIf\"], [\"slot\", \"start\"], [\"defaultHref\", \"pesquisar\", \"text\", \"\", 1, \"margin\"], [4, \"ngIf\"], [\"size\", \"large\", 1, \"centertt\"], [1, \"card\"], [1, \"imagem\", 3, \"src\"], [\"lines\", \"none\"], [\"size\", \"small\", \"color\", \"primary\", \"slot\", \"start\", 3, \"disabled\", \"click\"], [\"size\", \"large\", \"name\", \"chatbubble-sharp\", \"slot\", \"start\"], [\"name\", \"calendar-outline\", \"item-start\", \"\"], [1, \"com\"], [3, \"click\"], [\"name\", \"globe-outline\"], [3, \"click\", 4, \"ngIf\"], [\"name\", \"person-sharp\"], [\"no-lines\", \"\"], [\"placeholder\", \"Comentario:\", \"type\", \"string\", 3, \"ngModel\", \"ngModelChange\"], [\"color\", \"primary\", 3, \"disabled\", \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"name\", \"location-sharp\", \"size\", \"large\"], [\"id\", \"output\"], [\"item-start\", \"\"], [3, \"src\"]],\n    template: function EventoPesquisaPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\");\n        i0.ɵɵelementStart(1, \"ion-toolbar\");\n        i0.ɵɵtemplate(2, EventoPesquisaPage_ion_title_2_Template, 2, 1, \"ion-title\", 0);\n        i0.ɵɵelementStart(3, \"ion-buttons\", 1);\n        i0.ɵɵelement(4, \"ion-back-button\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, EventoPesquisaPage_ion_content_5_Template, 32, 10, \"ion-content\", 3);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.pode);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.pode);\n      }\n    },\n    directives: [i1.IonHeader, i1.IonToolbar, i7.NgIf, i1.IonButtons, i1.IonBackButton, i1.IonBackButtonDelegate, i1.IonTitle, i1.IonContent, i1.IonCard, i1.IonList, i1.IonItem, i1.IonButton, i1.IonIcon, i1.IonInput, i1.TextValueAccessor, i8.NgControlStatus, i8.NgModel, i7.NgForOf, i1.IonAvatar],\n    styles: [\"#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}.margin[_ngcontent-%COMP%]{padding-right:1em;margin-right:1em;--icon-margin-end: 1em;--icon-padding-end: 1em}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}ion-toolbar[_ngcontent-%COMP%]{--padding-top: 24px ;--background: black;--color: white}ion-content[_ngcontent-%COMP%]{--background: black}#center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;background-color:#000}.centertext[_ngcontent-%COMP%]{text-align:center}.centertt[_ngcontent-%COMP%]{margin-left:.5em;text-align:center;background-color:#000;color:#fff}.branco[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{align-content:center;background-color:#1c1c1c;color:#fff;text-align:center}.fundo[_ngcontent-%COMP%]{background-color:#000;color:#fff}.imagem[_ngcontent-%COMP%]{height:50%;width:100%;align-content:center!important;max-height:35vh!important;width:100%!important;-o-object-fit:cover!important;object-fit:cover!important}.textevent[_ngcontent-%COMP%]{color:#fff;margin-right:25ex}ion-item[_ngcontent-%COMP%]{--background: #000000;--color:#FFFFFF}.a[_ngcontent-%COMP%]{margin-top:1ex;font-family:sans-serif;font-style:Trebuchet;font-weight:bold;font-size:x-large}.com[_ngcontent-%COMP%]{font-size:2ex;padding-left:1ex}.inic[_ngcontent-%COMP%]{--padding-start: 18ex;letter-spacing:0,5ex}\"]\n  });\n  return EventoPesquisaPage;\n})();","map":null,"metadata":{},"sourceType":"module"}